\documentclass[a4paper]{article}
\usepackage{import}
\input{../../setup.sty}
\title{Sistemi}
\author{Università di Verona\\Imbriani Paolo -VR500437\\Professor Francesco Visentin}

\begin{document}

\begin{figure}
    \centering
    \includegraphics[width=0.3\textwidth]{UniversityofVerona.png}
    \label{fig:centered-image}
\end{figure}

\maketitle 

\pagebreak

\tableofcontents

\pagebreak

\section{Trasformata di Laplace}

\begin{definition}
$v(t)$ è definito nel tempo. V(s) è la sua trasformata. 
    \[\mathcal{L}[f(t)](s) = \int_{0}^{+\infty} v(t)e^{-st}dt\]
\end{definition}

\begin{figure}[H]
    \centering
    \caption{$\alpha \ge max\{\lambda_i\}$}
    \begin{tikzpicture}
        % Axes
        \draw[->] (-1, 0) -- (8, 0) node[right] {$\operatorname{Re}$};
        \draw[->] (0, -1) -- (0, 4) node[above] {$\operatorname{Im}$};
    

        \draw[thick] (1, 0) -- (1, 2);
        \node[above] at (1, 2) {$\lambda_1$};
        \draw[thick] (2.3, 0) -- (2.3, 3);
        \node[above] at (2.3, 3) {$\lambda_2$};
        \draw[thick] (3, 0) -- (3, 3.5);
        \node[above] at (3, 3.5) {$\lambda_3$};
    
        % Dashed line for region boundary at x = 4.5
        \draw[dashed, thick, green!60!black] (4.5, -1) -- (4.5, 4);
        \node[below, green!60!black] at (4.2, 0) {$\alpha_0$};
    
        % Green filled region of convergence
        \fill[green!20] (4.5, -1) rectangle (8, 4);

    \end{tikzpicture}
\end{figure}


\subsection{Proprietà}

La trasformata di LaPlace ha svariate utili proprietà che possiamo utilizzare a nostro vantaggio:
\indent
\begin{property}
\label{prop:linearity_lap}
    \textbf{Linearità}: \[a_1v_1(t) + a_2v_2(t) = a_1V_1(s) + a_2V_2(s)\]
\end{property}
\begin{property}
\label{prop:traslas_time_lap}
    \textbf{Traslazione nel dom. del tempo: } \[\mathcal{L}[v(t-\tau)](s) = \overbrace{e^{-st}V(s)}^{\tau > 0}\]
\end{property}
\begin{property}
\label{prop:traslas_compl_lap}
    \textbf{Tralaslazione nel dom. dei complessi: }
    \[\mathcal{L}[e^{\lambda t}v(t)] = V(s - \lambda)\]
\end{property}
\begin{property}
\label{prop:cambio_di_scala}
    \textbf{Cambio di scala:}
    \[\mathcal{L}[v(rt)](s) = \frac{1}{r}V\left(\frac{s}{r}\right)\]
\end{property}
\begin{property}
\label{prop:derivata_lap}
    \textbf{Proprietà delle derivate:} Se $v(t)$ ammette TdL (Trasformata di Laplace) ed esiste finito $v(0^-) = \lim_{t \rightarrow 0} v(t)$ 
    allora anche la sua derivata i-esima ammette TdL.
    \[\mathcal{L}\left[\frac{d^iv(t)}{dt}\right] = S^iV(s) - \sum_{k = 0}^{i-1} \frac{d^kv(t)}{d^t}\bigg|_{t = 0^-} (S^{i-1-k})\]
\end{property}
\begin{proof}
    Per la derivata prima:
    \begin{align*}
        \mathcal{L}\left[\frac{d}{dt}v(t)\right](s) &= \int_{0}^{\infty} \frac{d}{dt}v(t)e^{-st}dt =\\ 
        &= v(t)e^{-st}\bigg|_0^{+\infty} + s\int_{0}^{\infty}v(t)e^{-st}dt\\
        &= \lim_{\varepsilon \rightarrow 0} v(\varepsilon)e^{-s\varepsilon} - \lim_{\varepsilon \rightarrow 0^-} v(\varepsilon)e^{-s\varepsilon} + sV(s)\\
        &= sV(s) - v(0^-)
    \end{align*}
\end{proof}
\begin{proof}
    Per la derivata seconda:
    \begin{align*}
        \mathcal{L}\left[\frac{d^2}{dt^2}v(t)\right](s) &= \mathcal{L}\left[\frac{d}{dt}\left(\frac{d}{dt}v(t)\right)\right](s)\\  &= s\mathcal{L}\left[\frac{d}{dt}v(t)\right](s) - \frac{d}{dt} v(t)\bigg|_{t = 0^-}\\
        &= \int_{0}^{+\infty} \left[S\mathcal{L}[v(t)](s) - v(0^-)\right] - \frac{d}{dt}v(t)\bigg|_{t = 0^-}\\
        &= s^2V(s) - sv(0^-) - \frac{d}{dt}v(t)\bigg|_{t = 0^-}
    \end{align*}
\end{proof}
\begin{property}
    \label{prop:molt_funz_pol}
    \textbf{Moltiplicazione per funzioni polinomiali:} Se $v(t)$ ammette TdL e t è un polinomio allora anche $tV(s)$ ammette TdL.
    \[\mathcal{L}[t^iv(t)](s) = (-1)^i\frac{d^iV(s)}{dS^i}\]
\end{property}
\begin{proof}
    \textbf{Per $i = 1$}: 
    \begin{align*}
        \mathcal{L}[tv(t)](s) = \int_{0^-}^{+\infty} tv(t)e^{-st}dt &= -\int_{0^-}^{+\infty}v(t) \cdot (te^{-st})dt\\
        &= -\int_{0}^{+\infty} v(t)\frac{d}{ds}te^{-st}dt \\
        &= -\frac{d}{ds}\overbrace{\int_{0}^{\infty}v(t)e^{-st}dt}^{\text{TdL}}\\
        &= -\frac{d}{ds}V(s)
    \end{align*}
\end{proof}
\begin{property}
    \textbf{Integrazione nel dom. del tempo}: Se $v(t)$ ammette TdL, allora $\Psi(t) = \int_{0^-}^{t}v(t)dt$ ammette TdL
    \[\mathcal{L}[\Psi(t)](s) = \frac{V(s)}{s}\]
    Ascissa di convergenza: $\alpha = max\{0, \alpha_0\}$
\end{property}
\begin{proof}
    \begin{align*}
        v_1(t) = \int_{0^-}^{\infty} v(t)dt \Longrightarrow \begin{cases}
            v_1' = v(t)\\
            v(0^-) = \int_{0^-}^{0^-}v(t)dt = 0
        \end{cases}
    \end{align*}
    \begin{align*}
        V(s) = \mathcal{L}[v(t)](s) &= \mathcal{L}[v_1'(t)](s) = S\mathcal{L}[v_1'(t)](s) - v_1(0^-)\\
        &= \mathcal{L}\left[\int_{0}^{t}v(t)dt\right](s)\\ &= \frac{V(s)}{s}
    \end{align*}
\end{proof}
\begin{property}
    \textbf{Integrazione nel dom. dei complessi}: Se $v(t)$ ammette TdL e esiste $\lim_{t \rightarrow 0^-}\frac{v(t)}{t}$
    allora:
    \[\mathcal{L}\left[\frac{v(t)}{t}\right](s) = \int_{s}^{\infty} \mathcal{L}[v(t)](\zeta)d\zeta\]
\end{property}
\begin{proof}
    \begin{align*}
        \int_{s}^{+\infty} \mathcal{L}[v(t)](\zeta)d\zeta &= \int_{s}^{\infty} \int_{0^-}^{\infty} v(t)e^{-st} dtd\zeta\\
        &= \int_{0^-}^{\infty} v(t)\underbrace{\left(\int_{s}^{+\infty}e^{-t\zeta}d\zeta\right)}_{= \frac{e^{-st}}{t}}dt\\
        &= \int_{0}^{\infty}\frac{v(t)}{t}e^{-st}dt = \mathcal{L}\left[\frac{v(t)}{t}\right](s)
    \end{align*}
\end{proof}
\begin{theorem}
    \label{thm:val_iniziale_lap} \textbf{Teorema del valore iniziale}:
    Se $v(t)$ ammette TdL ed esiste finito $\lim_{t \rightarrow 0^-}v(t)$ allora 
    \[\lim_{t \rightarrow 0^-} v(t) = \lim_{s \rightarrow \infty} S\mathcal{L}[v(t)](s)\]
\end{theorem}
\begin{theorem}
    \label{thm:val_finale_lap} \textbf{Teorema del valore finale}:
    Se $v(t)$ ammette TdL ed esiste finito $\lim_{t \rightarrow \infty}v(t)$ allora 
    \[\lim_{t \rightarrow \infty} v(t) = \lim_{s \rightarrow 0^+} S\mathcal{L}[v(t)](s)\]
\end{theorem}
\begin{property}
    \textbf{Convoluzione nel dom. del tempo}: Siano $u(t)$ e $v(t)$ due funzioni causali (nulla per $t<0$) che ammettono TdL, allora la loro convoluzione $(u \ast v)(t)$ ammette TdL. 
    \[\mathcal{L}[(u \ast v)(t)](s) = \mathcal{L}[u(t)](s) \cdot \mathcal{L}[v(t)](s)\]
\end{property}
\begin{proof}
    \begin{align*}
        \mathcal{L}[(u \ast v)(t)](s) &= \int_{0}^{+\infty} (u \ast v)(t)e^{-st}dt\\
        &= \int_{0}^{+\infty} \left(\int_{0}^{t}u(\tau)v(t-\tau)d\tau\right)e^{-st}dt\\
        &= \int_{0}^{+\infty} \int_{0}^{t}u(\tau)v(t-\tau)e^{-st}d\tau dt\\
        &= \int_{0^-}^{\infty} u(\tau)\left(\int_{0^-}^{\infty} v(t-\tau)e^{-st}dt\right)d\tau\\
    \end{align*}
    Sostituiamo $x = t - \tau \rightarrow t = x + \tau \rightarrow dt = dx$ 
    \begin{align*}
        &= \int_{0^-}^{\infty} u(\tau)\left(\int_{0^-}^{\infty} v(x)e^{-s(x+\tau)}dx\right)d\tau\\ 
        &= \int_{0}^{+\infty} u(\tau)e^{-s\tau}d\tau \cdot \int_{0}^{+\infty}v(x)e^{-sx}dt\\
        &= \mathcal{L}[u(t)](s) \cdot \mathcal{L}[v(t)](s)
    \end{align*}
\end{proof}

\subsection{Trasformate di funzioni notevoli}
Ora andremo a vedere le trasformate di alcune funzioni notevoli:\\
Trasformata dell'\textbf{impulso unitario}:

\begin{figure}[H]
    \centering
\begin{tikzpicture}
    % Unitary Impulse Function (Delta Function)

        % Axes
        \draw[->] (-2, 0) -- (2, 0) node[right] {$t$};
        \draw[->] (0, -0.5) -- (0, 2) node[above] {$\delta(t)$};

        % Impulse at t = 0
        \draw[thick, ->] (0, 0) -- (0, 1.5);
        \node[above] at (0, 1.5) {$1$};

        % Labels
        \node[below left] at (0, 0) {$0$};
        \node at (0, -1) {Unit Impulse $\delta(t)$};
\end{tikzpicture}
\end{figure}

\[\mathcal{L}[\delta(t)](s) = \int_{0}^{+\infty} \delta(t)e^{-st}dt = e^{-s \cdot 0} = 1\]
Ampiezza:
\[\mathcal{L}[A\delta_0(t)](s) = A\overbrace{\cancel{\mathcal{L}[\delta_0(t)](s)}}^{1} = A\]
Ritardato nel tempo:
\[\mathcal{L}[\delta(t-\tau)](s) = e^{-st}\mathcal{L}[\delta_0(t)](s) = e^{-s\tau}\]

\begin{figure}[H]
    \centering
    \begin{tikzpicture}
    % Space between the graphs
        % Unit Step Function (Heaviside Function)
        % Axes
        \draw[->] (-2, 0) -- (2, 0) node[right] {$t$};
        \draw[->] (0, -0.5) -- (0, 2) node[above] {$u(t)$};

        % Step function
        \draw[thick] (-2, 0) -- (0, 0);
        \draw[thick] (0, 1) -- (2, 1);
        \draw[fill=white] (0, 1) circle (2pt);  % Open circle at t=0
        \node[left] at (0, 1) {$1$};

        % Labels
        \node[below left] at (0, 0) {$0$};
        \node at (0, -1) {Unit Step $u(t)$};
\end{tikzpicture}
\end{figure}

\begin{align*}
    \mathcal{L}[\delta_{-1}(t)](s) &= \int_{0^-}^{\infty} \delta_{-1}(t)e^{-st}dt\\
    &= \int_{0^-}^{\infty}e^{-st}dt \\
    &= \frac{e^{-st}}{-s}\bigg|_{0^-}^{\infty} = \frac{1}{s}
\end{align*}
\begin{align*}
    \mathcal{L}[A\delta_{-1}(t)](s) &= A\mathcal{L}[\delta_{-1}(t)](s) = \frac{A}{s}\\
    &= \mathcal{L}[\delta_{t - \tau}](s) \\
    &= e^{-s\tau}\mathcal{L}[\delta_{-1}(t)](s) \\
    &= \frac{e^{-s\tau}}{s}
\end{align*}
\noindent
\textbf{Esponenziale complesso causale}: $v(t) = e^{\lambda t}\delta_{-1}(t)$

\begin{figure}[H]
\centering
\begin{tikzpicture}
    \begin{axis}[
        axis lines = middle,
        xlabel = {$x$},
        ylabel = {$f(x), g(x)$},
        xmin = -0.5, xmax = 3,
        ymin = -0.5, ymax = 10,
        samples = 100,
        domain = -3:3,
        every axis x label/.style={at={(current axis.right of origin)}, anchor=west},
        every axis y label/.style={at={(current axis.above origin)}, anchor=south},
        xtick={-3,-2,-1,0,1,2,3},
        ytick={1,2,4,6,8,10},
        enlargelimits
    ]

        % Plot of e^x (exponential growth)
        \addplot[thick, red] {exp(x)};
        \node[red, above] at (axis cs:1,6) {$f(x) = e^x$};

        % Plot of e^-x (exponential decay)
        \addplot[thick, blue] {exp(-x)};
        \node[blue, above] at (axis cs:1.5,1) {$g(x) = e^{-x}$};

    \end{axis}
\end{tikzpicture}
\end{figure}


\begin{align*}
    \mathcal{L}[e^{\lambda t}\delta_{-1}(t)](s) &= \mathcal{L}[\delta_{-1}(t)](s - \lambda) \\
    &= \frac{1}{s - \lambda}
\end{align*}
\[\mathcal{L}[Ae^{\lambda t}\delta_{-1}(t)](s) = \frac{A}{s-\lambda}\]
\[\mathcal{L}[e^{\lambda(t - \tau)}\delta_{-1}(t - \tau)](s) = \frac{e^{-(s-\lambda)\tau}}{s-\lambda}\]
\textbf{Esponenziale complesso causale moltiplicato per una funzione polinomiale}: \[v(t) = \frac{t^l}{l!}e^{\lambda t}\delta_{-1}(t)\]


\begin{align*}
    \mathcal{L}\left[\frac{t^l}{l!}e^{\lambda t}\delta_{-1}(t)\right](s) &= \frac{1}{l!}\mathcal{L}[t^l e^{\lambda t}\delta_{-1}(t)](s)\\
    &\stackrel{\ref{prop:traslas_time_lap}}{=} \frac{(-1)^l}{l!}\frac{d^l}{dS^l}\mathcal{L}[e^{\lambda t}\delta_{-1}(t)](s)\\
    &= \frac{(-1)^l}{l!}\frac{d^l}{dS^l}\frac{1}{s-\lambda}\\
    &= \frac{(-1)^l}{l!}\frac{l! (-1)^l}{(s-\lambda)^{l+1}}\\
    &= \frac{1}{(s-\lambda)^{l+1}}
\end{align*}
\begin{examplebox}{Esempio 1}
    Con l = 1 
    \[\mathcal{L}[te^{e^{\lambda t}}\delta_{-1}(t)](s) = \frac{1}{(s-\lambda)^2}\]
    Con l = 2
    \[\mathcal{L}\left[\frac{t^2}{2!}e^{\lambda t}\delta_{-1}(t)\right](s) = \frac{1}{(s-\lambda)^3}\]
\end{examplebox}
\noindent
\textbf{Funzione coseno}:
\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            axis lines = middle, 
            xlabel={$x$}, ylabel={$y$},
            domain=0:2*pi, 
            grid=both,
            xmin=0, xmax=2*pi, ymin=-1.5, ymax=1.5
        ]
            \addplot[red, thick] {cos(deg(x))};
            \legend{$\cos(x)$}
        \end{axis}
        \end{tikzpicture}
\end{figure}
\begin{align*}
\mathcal{L}[cos(wt)](s) &\stackrel{Eulero}{=} \mathcal{L}\left[\frac{e^{jwt} - e^{-jwt}}{2}\right]\\
&= \frac{1}{2}\left[\mathcal{L}[e^{jwt}](s) - \mathcal{L}[e^{-jwt}](s)\right] \\
&= \frac{1}{2}\left[\frac{1}{s-jw} + \frac{1}{s+jw}\right] \\
&= \frac{s}{s^2 + w^2}
\end{align*}
\textbf{Funzione seno}:
\begin{figure}[H]
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            axis lines = middle, 
            xlabel={$x$}, ylabel={$y$},
            domain=0:2*pi, 
            grid=both,
            xmin=0, xmax=2*pi, ymin=-1.5, ymax=1.5
        ]
            \addplot[blue, thick] {sin(deg(x))};
            \legend{$\sin(x)$}
        \end{axis}
        \end{tikzpicture}
\end{figure}
\begin{align*}
    \mathcal{L}[sin(wt)](s) &\stackrel{Eulero}{=} \mathcal{L}\left[\frac{e^{jwt} - e^{-jwt}}{2j}\right]\\
    &= \frac{1}{2j}\left[\mathcal{L}[e^{jwt}](s) - \mathcal{L}[e^{-jwt}](s)\right] \\
    &= \frac{1}{2j}\left[\frac{1}{s-jw} - \frac{1}{s+jw}\right] \\
    &= \frac{1}{2j}\left[\frac{\cancel{s}+jw - \cancel{s}+jw}{s^2 + w^2}\right] \\
    &= \frac{w}{s^2 + w^2}
\end{align*}

\subsection{Applicazione della TdL per i sistemi LTI causali}
\begin{equation*}
    \color{red}
    \sum_{i=0}^{n} a_i \frac{d^iv(t)}{dt^i} = \sum_{j=0}^{m} b_j \frac{d^ju(t)}{dt^j}
\end{equation*}
\[n \ge m \text{ e } u(t) = u(t)\cdot \delta_{-1}(t) (u(t)=0, t<0)\]
E consideriamo le n-1 condizioni iniziali:
\[v(0^-), \; \frac{dv(0)}{dt}; \; \frac{d^2v(0)}{dt^2}; \; \dots \; \frac{d^{n-1}v(0)}{dt^{n-1}}\]
Se $u(t)$ ammette TdL allora anche $v(t)$ ammette TdL e:
\begin{equation*}
    \mathcal{L}\left[\sum_{i=0}^{n} a_i \frac{d^iv(t)}{dt^i}\right](s) = \mathcal{L}\left[\sum_{i=0}^{m} b_i \frac{d^iu(t)}{dt^i}\right](s)
\end{equation*}
\begin{equation*}
    \sum_{i=0}^{n} a_i \mathcal{L}\left[\frac{d^iv(t)}{dt^i}\right](s) = \sum_{i=0}^{m} b_i \mathcal{L}\left[\frac{d^iu(t)}{dt^i}\right](s)
\end{equation*}
Applicando $n+m$ volte la regole della derivata:\\
\begin{align*}
   &a_n\left[S^nV(s) - \sum_{k=0}^{n-1}\frac{d^kv(t)}{dt^k}\bigg|_{t=0^-}(S^{n-1-k})\right] + \\
   &+ a_{n-1}\left[S^{n-1}V(s) - \sum_{k=0}^{n-2}\frac{d^kv(t)}{dt^k}\bigg|_{t=0^-}(S^{n-2-k})\right] +\\
   &+ \dots + a_0V(s)\\
   &= b_mS^mU(s) + b_{m-1}S^{m-1}U(s) + \dots + b_0U(s)
\end{align*}
Imponiamo le C.I.: $u(t)\bigg|_{t=0} = 0$\\\\
Espandiamo e raccogliamo:
\begin{align*}
    &\underbrace{\left[a_nS^n + a_{n-1}S^{n-1} + \dots + a_0\right]V(s)}_{d(s)} +\\
    &- \underbrace{a_nv(0^-)S^{n-1}\left(a_{n-1}v(0^-) + a_n\frac{dv(t)}{dt}\bigg|_{t=0^-}\right)S^{n-2} - \; \dots \; - \left(\sum_{k=0}^{n-1} a_{k+1} \frac{d^kv(t)}{dt^k}\bigg|_{t=0^-}\right)}_{p(s)}\\
    &= \underbrace{(b_mS^m + b_{m-1}S^{m-1} + \dots + b_0)}_{n(s)}U(s)
\end{align*}

\[\Longrightarrow d(s) \cdot V(s) - p(s) = n(s) \cdot U(s)\]
\[V(s) = \frac{n(s)}{d(s)} \cdot U(s) + \frac{P(s)}{d(s)}\]
\begin{itemize}
    \item \textcolor{green!70!black}{$n(s)$} è un polinonio di grado $m$
    che dipende solo dai coefficenti delle derivate associate all'ingresso. \colorbox{blue!30!white}{Polinimonio caratteristico di u(t)}
    \item \textcolor{green!70!black}{$d(s)$} è un polinomio di grado $n$ che dipende
    solo dai coefficenti delle derivate associate di uscita. \colorbox{blue!30!white}{Polinimonio caratteristico di v(t)}
    \item \textcolor{green!70!black}{$p(s):$}\[\sum_{k=0}^{n-1}S^k\left(\sum_{j=k+1}^{n} a_{j+1} \frac{d^{n-j}}{dt^{n-j}}\bigg|_{t=0^-}\right)\]
    Polinomio di grado $n-1$ che dipende solo dalle C.I di v(t)
    \item \textcolor{green!70!black}{$\frac{P(s)}{d(S)}$} è una funzione razionale che dipende solo dalle C.I ì del sistema e dai 
    coefficenti del polinomio caratteristico di $v(t)$
    \[V_l(s) = \frac{P(s)}{d(s)}\]
    \item \textcolor{green!70!black}{$\frac{n(s)}{d(s)}U(s)$} è una funzione razionale che dipende dai coefficenti
    del polinomio caratteristico di $u(t)$, dei coefficenti del polinomio caratteristico di v(t) moltiplicati per tali u(t):
    \[V_f(s) = \frac{n(s)}{d(s)}U(s)\]
\end{itemize}

\begin{examplebox}{Esempio}
    Dato un sistema LTI:
    \[\frac{d^3v(t)}{dt^3} + \frac{d^2v(t)}{dt^2} = \frac{du(t)}{dt}\]
    \[\downarrow\]
    \[\textcolor{green!60!black}{\mathcal{L}\left[\frac{d^3v(t)}{dt^3}\right]} + \textcolor{blue!80!black}{\mathcal{L}\left[\frac{d^2v(t)}{dt^2}\right]} = \textcolor{red!80!black}{\mathcal{L}\left[\frac{du(t)}{dt}\right]}\]
    \[\downarrow\]
    \[\textcolor{green!60!black}{S^3V(s) - S^2v(0^-) - S\frac{dv(0^-)}{dt} - \cancel{S^0}\frac{d^2v(0^-)}{dt^2}} +\]
    \[\textcolor{blue!80!black}{+ S^2V(s) - Sv(0^-) - \frac{dv(0^-)}{dt}} = \textcolor{red!80!black}{SU(s)}\]
    \[\underbrace{(S^3 + S^2)}_{d(s)}V(s) - \underbrace{\left[s^2v(0) + \frac{dv(0)}{dt}S + \frac{d^2v(0)}{dt^2} + v(0)S + \frac{dv(0)}{dt}\right]}_{p(s)} = \underbrace{S}_{n(s)}U(s)\]
    \[V(s) = \frac{S}{(S^3 + S^2)}U(s) + \frac{\left[s^2v(0) + \frac{dv(0)}{dt}S + \frac{d^2v(0)}{dt^2} + v(0)S + \frac{dv(0)}{dt}\right]}{S^3 + S^2}\]
\end{examplebox}
\noindent
H(s) è definita come TdL delle risposte impulsive $h(t)$. È una funzione razionale con grado del numeratore 
generalemnte minore o uguale del denominatore.
\begin{align*}
    h(t) &= d_0 \delta_0(t) + ... \left(\sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} d_{i,l}\frac{t^l}{l!}e^{\lambda_i t}\right)\delta_{-1}(t)\\
    &\stackrel{\mathcal{L}}{=} d_0 + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} \frac{d_{i,l}}{(s-\lambda)^{l+1}} = H(s)
\end{align*}
\subsubsection{Funzione di trasferimento}
    \begin{align*}
        H(s) &= \frac{\sum_{j=0}^{m}b_js^j}{\sum_{i=0}^{n}a_is^i}\\
        &= \frac{b_m(S-\beta)^{\zeta_1}(S-\beta_2)^{\zeta_2}\; ... \; (S-\beta_q)^{\zeta_q}}{a_n(S-\alpha)^{\mu_1}(S-\alpha_2)^{\mu_2}\; ... \; (S-\alpha_n)^{\mu_r}}
    \end{align*}
    \begin{center}
    \colorbox{blue!30!white}{Rapporto tra i polinomi car. di u(t) e v(t)}\\
    Dove $\alpha_i$ e $\beta_j$ sono rispettivamente radici del denominatore e del numeratore.
    \end{center}
    Possiamo anche riscriverla come:
    \[H(s) = k\frac{\prod_{i = 1}^m (S - Z_i)}{\prod_{i = 1}^n (S - P_i)} \; \;  \text{ dove } \; \; k = \frac{b_m}{a_n}\]
    Dove $(S - Z_i)$ e $(S - P_i)$ sono rispettivamente zeri e poli della funzione razionale. 
    

    \begin{definition}
        Definiamo come zero di una funzione razionale $H(s)$ un qualiasi numero $\beta \in \mathbb{C}$ t.c. $H(\beta) = 0$.
    \end{definition}
    \begin{definition}
        Definiamo come polo di una funzione razionale $H(s)$ un qualunque numero $\alpha \in \mathbb{C}$ t.c. $H(\alpha) = \infty$.
    \end{definition}
    \noindent
    Dato H(s) in forma ridotta (ho eliminato le radici in comune): Siano $\lambda_1, \; ... \; \lambda_r$ con $r \le n$ i suoi poli dopo la semplificazione
    se $Re(\lambda_i) < 0$ per $i = 1, \; ... \; r$ allora il sistema è BIBO stabile. 
    \begin{lemma}
        \label{lemma:polo_bibo_stabile}
        Un sistema è BIBO stabile se tutti i suoi poli giaciono nel semipiano complesso negativo.
    \end{lemma}
    \noindent
    Per stabilizzare un sistema (BIBO stabilizzato) devo togliere gli zeri $\lambda_i$ con $Re(\lambda_i) > 0$, dividendoli per il loro corrispettivo polo.

\begin{examplebox}{Esempio 1}
    \[v'(t) - 3v(t) = u''(t) - 5u'(t) + 4u(t)\]
    Calcoliamoci il polinomio caratteristico:
    \[s - 3 = s^2 - 5s + 4\]
    \[H(s) = \frac{n(s)}{d(s)} = \frac{\text{Pol. Car degli ingressi}}{\text{Pol. Car delle uscite}} = \frac{s^2 -5s + 4}{s - 3}\]
    \[H(s) = \frac{s^2 - 5s + 4}{s - 3} = \frac{(s-4)(s-1)}{s-3}\]
    Poiché $\lambda_1 = 3$ non è asintonticamente stabile poiché la sua parte reale è maggiore di 0.\\ Non è neanche BIBO stabile
    perché tutte le radici del denominatore (poli di $H(s)$) hanno parte reale maggiore di 0.
\end{examplebox}
\begin{examplebox}{Esempio 2}
    \[v''(t) + 3v'(t) + 2v(t) = u''(t) - 4u'(t) + 3u(t)\]
    \[H(s) = \frac{s^2 - 4s + 3}{s^2 + 3s + 2} = \frac{(s-3)(s-1)}{(s+1)(s+2)}\]
    Poiché $\lambda_1 = -1$ e $\lambda_2 = -2$ sono minori di 0 allora il sistema è asintonticamente stabile. Ricordiamo che se un sistema è 
    asintonticamente stabile allora è anche BIBO stabile.
\end{examplebox}
 \begin{examplebox}{Esempio 3}
    \[v'''(t) + 7v''(t) - 2v'(t) + 6v(t) = u''(t) + 3u(t) - 4u(t)\]
    \[H(s) = \frac{s^2 + 3s - 4}{s^3 + 7s^2 - 2s + 6} = \frac{(s+4)\cancel{(s-1)}}{\underbrace{(s+3)}_{\lambda_1 = -3}\underbrace{(s+2)}_{\lambda_2 = -2}\cancel{(s-1)}}\]
    Non è asintonticamente stabile. Tuttavia è BIBO stabile poiché tutti i poli di $H(s)$ hanno parte reale minore di 0.
 \end{examplebox}

\section{Antitrasformata di Laplace}

\[V(s) = \frac{n(s)}{d(s)} \Longrightarrow \begin{cases}
    \underbrace{deg[n(s)] \ge deg[d(s)]}_{\text{Sistema proprio}} \Longrightarrow A\\
    \underbrace{deg[n(s)] < deg[d(s)]}_{\text{Sistema strett. proprio}} \Longrightarrow B
\end{cases}\]

\begin{center}
    A $\rightarrow$ Divisione polinomiale $\rightarrow$ Fratti semplici $\rightarrow$ Antitrasformata\\
    B $\rightarrow$ Fratti complessi $\rightarrow$ Antitrasformata
\end{center}
\subsection{Divisione polinomiale}
\[V(S) = \frac{r(s)}{d(s)} + k \; \; \text{    dove    } \; \; deg[r(s)] < deg[d(s)], k \in \mathbb{C}\]
 \[\mathcal{L}[K\delta(t)] = K \stackrel{\mathcal{L}^{-1}}{\Longrightarrow} K\delta_0(t)\]
\begin{examplebox}{Esempio}
    \[V(s) = \frac{2s^2 + 4s - 3}{s^2 - s - 1} \; \; \text{ dove } \; \; m = 2, n=2\]
    \[
    \begin{array}{r|l}
    \text{Quotient} & 2 \\ \hline
    \text{Divisor} & s^2 - s - 1 \\
    \text{Step 1: } & 2s^2 + 4s - 3 \\
    \text{Subtract: } & -(2s^2 - 2s - 2) \\
    \text{Remainder: } & 6s - 1 \\
    \end{array}
    \]
    \[V(s) = \frac{6s - 1}{s^2 - s + 1} + 2\]
\end{examplebox}

\subsection{Fratti semplici}

\[\frac{r(s)}{d(s)} =  d_0 + \sum_{i=1}^{r} \sum_{l=0}^{\mu_i - 1} \frac{d_{i,l}}{(s-\lambda)^{l+1}}  \]

\begin{examplebox}{Esempio 1}
    \[V(s) = \frac{3s^2 - 1}{(s+1)^2(s-2)(s+5)}\]
    \[V(s) = \frac{A}{s-2} + \frac{B}{s+1} + \frac{C}{(s+1)^2} + \frac{D}{(s+5)}\]
    $A, B, C, D$ sono i $c_{i,l}$
\end{examplebox}
\begin{examplebox}{Esempio 2}
    \[\frac{s-20}{(s+4)(s-2)} = \frac{c_{1,0}}{(s+4)} + \frac{c_{2,0}}{s-2} = \frac{A}{s+4} + \frac{B}{s-2}\]
    \begin{enumerate}
        \item Metodo: \[\frac{A(s-2)+B(s+4)}{(s+4)(s-2)} = \frac{AS - 2A + BS + 4b}{(s+4)(s+2)}\]
        \[\begin{cases}
            A + B = 1\\
            -2A + 4B = -20
        \end{cases} \rightarrow \begin{cases}
            A = 4\\
            B = -3
        \end{cases}\] 
        \[\frac{S - 20}{(s+4)(s-2)} = \frac{4}{s+4} - \frac{3}{s-2}\]
        \item Metodo: \[c_{i,l} = \lim_{s \rightarrow \alpha_i}\frac{d^{\mu_i-l-1}\left((s-\alpha_i)^{\mu_i}\frac{r(s)}{d(s)}\right)}{ds^{\mu_i-l-1}}\]
        \[c_1  =  A = \lim_{s \rightarrow -4} \frac{\cancel{d^{1-0-1}}\left((s+4)^{1}\frac{s-20}{(s+4)(s-2)}\right)}{ds^0} = \frac{-24}{-6}= 4\]
        \[c_2  =  B = \lim_{s \rightarrow 2} \frac{d^{1-0-1}\left((s-2)^{1}\frac{s-20}{(s+4)(s-2)}\right)}{\cancel{ds^0}} = \frac{-18}{6}= -3\]
        \[\frac{S - 20}{(s+4)(s-2)} = \frac{4}{s+4} - \frac{3}{s-2}\]
    \end{enumerate}
\end{examplebox}
\noindent
Ora si applica l'antitrasformata:
\begin{align*}
    V(s) &= k + \sum_{i=1}^r \sum_{l=0}^{\mu_i - 1}\frac{c_{i,l}}{(s-\lambda_i)^{l+1}}\\
    &\stackrel{\mathcal{L}^{-1}}{=} \mathcal{L}^{-1}[k](t) + \sum_{i=0}^{r}\sum_{l=0}^{\mu_i - 1} \mathcal{L}^{-1}\left[\frac{c_{i,l}}{(s-\lambda_i)^{l+1}}\right](t)\\
    &= k\delta_0(t) +  \left[\sum_{i=0}^{r}\sum_{l=0}^{\mu_i - 1} c_{i,l} \frac{t^l}{l!}e^{\lambda_i t}\delta_{-1}(t)\right]
\end{align*}

\begin{examplebox}{Esempio completo}
    \[v''(t) - v'(t) - 2v(t) = u''(t) + 2u'(t) + u(t)\]
    \[C.I = \begin{cases}
        v(0) = 1\\
        v'(0) = 0
    \end{cases}\]
    \[u(t) = e^{3t}\delta_{-1}(t)\]
    Quello che ci viene chiesto è \begin{enumerate}
        \item Stabilità
        \item Risposta libera (nel tempo e in frequenza)
        \item Risposta impulsiva
        \item Risposta forzata
        \item Risposta totale
    \end{enumerate}
    Partiamo con il primo punto:
    \begin{enumerate}
        \item Polinomio caratteristico: $s^2 - s - 2 = 0 \rightarrow \lambda_1 = 2, \lambda_2 = -1$ e $\mu_i = 1$
        \textbf{Non è asintonticamente stabile} perché $\lambda_1 > 0$ 
        \[V(s) = \underbrace{\frac{p(s)}{d(s)}}_{V_l(s)} + \underbrace{\overbrace{\frac{h(s)}{d(s)}}^{H(s)} \cdot U(s)}_{V_f(s)}\]
        Per garantire stabilità BIBO i poli di $H(s)$ devono avere parte reale minore di 0.\\
        Calcoliamo la funzione di trasferimento:
        \[H(s) = \frac{s^2 + 2s + 1}{s^2 - s - 2} = \frac{(s+1)^{\cancel{2}}}{(s-2)\cancel{(s+1)}} = \frac{s+1}{s-2}\]
        \textbf{Non è BIBO stabile} perché $\lambda_1$ (che è un polo della funzione di trasferimento) è maggiore di 0.
        \item[2a. ] Risposta libera nel tempo:
        \begin{align*}
            v_l(t) &= \sum_{i = 1}^{r} \sum_{l = 0}^{\mu_i - 1} c_{i,l}\frac{t^l}{l!}e^{\lambda_it}\\
            &= c_{1}e^{2t} + c_{2}e^{-t}
        \end{align*}
        \[\begin{cases}
            v_l(t) = c_{1}e^{2t} + c_{2}e^{-t}\\
            v_l'(t) = 2c_{1}e^{2t} - c_{2}e^{-t}\\
        \end{cases} \stackrel{t = 0}{\rightarrow} \begin{cases}
            c_1 + c_2 = 1\\
            2c_1 - c_2 = 0
        \end{cases} \rightarrow \begin{cases}
            c_1 = 0\\
            c_2 = 1
        \end{cases}\]
        \[v_l(t) = e^{-t}\]
        
        \item[2b .] Risposta libera in frequenza:
        Facciamo la trasformata di Laplace del sistema:
         \[\mathcal{L}[v''(t) - v'(t) - 2v(t)] = \mathcal{L}[u''(t) + 2u'(t) + u(t)]\]
            \[\overbrace{(s^2V(s) - s + 1)}^{\mathcal{L}[v''(t)]} - \overbrace{(sV(s) + 1)}^{\mathcal{L}[v'(t)]} - \overbrace{2V(s)}^{\mathcal{L}[v(t)]} = (\overbrace{s^2U(s)}^{\mathcal{L}[u''(t)]} + \overbrace{2sU(s)}^{\mathcal{L}[u'(t)]} + \overbrace{U(s)}^{\mathcal{L}[u(t)]}\]
        \[\overbrace{(s^2 - s - 2)}^{\text{pol. car. uscite}}V(s) - s + 2 = \overbrace{(s^2 + 2s + 1)}^{\text{pol. car entrate}}U(s)\]
        \[V(s) = \frac{s - 2}{(s-2)(s+1)} + \frac{(s+1)^2}{(s-2)(s+1)} U(s)\]
        Vediamo ora cosa è $U(s)$:
        \[u(t) = \underbrace{e^{-3t}\delta_{-1}(t)}_{\lambda = -3, A = 1} \stackrel{\mathcal{L}}{\Longrightarrow} U(s) = \frac{1}{s+3}\]
        \[V(s) = \underbrace{\frac{1}{s+1}}_{v_l(s)} + \overbrace{\underbrace{\frac{s+1}{s-2}}_{H(s)} \cdot \frac{1}{s+3}}^{V_f(s)}\]
        Quindi la risposta libera in Laplace è: 
        \[v_l(s) = \underbrace{\frac{1}{s+1}}_{\lambda = 1, A = 1}\stackrel{\mathcal{L}^{-1}}{\Longrightarrow} e^{-t}\delta_{-1}(t)\]
        L'unica differenza che ci sta tra risposta libera e in frequenza e che quella in frequenza, quando la andiamo a trovare
        dobbiamo moltiplicarla per la funzione causale, ovvero il gradino.
        \item[3. ] Risposta impulsiva:
        \[H(s) = \frac{s+1}{s-2}\]
        Facciamo la divisione tra polinomi dove otteniamo:
        \[H(s) = 1 + \frac{3}{s-2}\]
        Applichiamo l'antitrasformata:
        h(t) = $\mathcal{L}^{-1}[H(s)] = \delta_0(t) + 3e^{2t}\delta_{-1}(t)$
        \item[4. ] Risposta forzata: Proviamo entrambi i metodi, partiamo con il primo (i fratti semplici):
        \[V_f(s) = \frac{s+1}{(s-2)(s+3)} = \frac{A}{s-2} + \frac{B}{s+3}\]
        \[\frac{As + 3A + Bs - 2B}{(s-2)(s+3)} = \frac{(A+B)s + (3A - 2B)}{(s-2)(s+3)}\]
        \[\begin{cases}
            A + B = 1\\
            3A - 2B = 1
        \end{cases} \rightarrow \begin{cases}
            A = 1 - \frac{2}{5} = \frac{3}{5}\\
            B = \frac{2}{5}
        \end{cases}\]
        \[\frac{3}{5}\frac{1}{s-2} + \frac{2}{5} \frac{1}{s+3} = \left(\frac{3}{5}e^{2t} + \frac{2}{5}e^{-3t}\right)\delta_{-1}(t)\]
        Okay ora proviamo con il metodo dei limiti:
        \[c_{i} = \lim_{s \rightarrow \lambda_i}\frac{d^{\mu - l - 1}n(s)}{ds^{s-l-1}d(s)}(s-\lambda)^\mu\]
        \[A = \lim_{S \rightarrow +2} \frac{d^{1-0-1}}{ds^{1-0-1}} \frac{s+1}{\cancel{(s-2)}(s+3)}\cancel{(s-2)} = \frac{3}{5}\]
        \[B =\lim_{S \rightarrow -3} \frac{d^{1-0-1}}{ds^{1-0-1}} \frac{s+1}{(s-2)\cancel{(s+3)}}\cancel{(s+3)} = \frac{2}{5} \]
        E come si vede, si ottiene il risultato medesimo con diverso metodo.
    \end{enumerate}
\end{examplebox}
\noindent


\end{document}