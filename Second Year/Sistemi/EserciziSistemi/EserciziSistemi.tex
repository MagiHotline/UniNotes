\documentclass[a4paper]{article}
\usepackage{import}
\input{../../../setup.sty}
\title{Esercizi di Sistemi}
\author{Università di Verona\\Imbriani Paolo -VR500437\\Professor Francesco Visentin}

\begin{document}

\begin{figure}
    \centering
    \includegraphics[width=0.3\textwidth]{UniversityofVerona.png}
    \label{fig:centered-image}
\end{figure}

\maketitle 

\pagebreak

\tableofcontents

\pagebreak

\section{Esercizi su risposta libera e impulsiva}

\subsection{Esercizio 1}
\begin{examplebox}{Consegna}
Dato il seguente sistema a tempo continuo (LTI):
\[v''(t) - 5v'(t) - 6v(t) = u'(t) + 5u(t)\]
e le seguenti condizioni iniziali:
\[\begin{cases}
    v(0) = 3\\
    v'(0) = 1
\end{cases}\]
Calcolare la risposta libera (1) e la risposta forzata/impulsiva del sistema (2).
\end{examplebox}
1. Per calcolare la risposta libera iniziamo a calcolare il polinomio caratteristico:

    \[s^2 - 5s - 6 = (s + 1)(s - 6)\]
    \[\lambda_1 = -1, \lambda_2 = 6\]
    \[\mu_1 = 1, \mu_2 = 1, r = 2\]
    \[v_l(t) = c_1e^{-t} + c_2e^{6t}\]
Ora derivo $v(t)$:
\[v'(t) = -c_1e^{-t} + 6c_2e^{6t}\]
Applico le condizioni iniziali:
\[\begin{cases}
    v(0) = 3\\
    v'(0) = 1
\end{cases} \begin{cases}
    c_1e^{-t} + c_2e^{6t} = 3\\
    -c_1e^{-t} + 6c_2e^{6t} = 1
\end{cases} \Longrightarrow \begin{cases}
    c_1 + c_2 = 3\\
    -c_1 + 6c_2 = 1
\end{cases} \Longrightarrow \begin{cases}
    c_1 = \frac{17}{7}\\
    c_2 = \frac{4}{7}
\end{cases}\]
\begin{equation*}
    \tcbox[nobeforeafter]{\(v_l(t) = \frac{17}{7}e^{-t} + \frac{4}{7}e^{6t}\)}
\end{equation*}
2. Ora calcoliamo la risposta impulsiva. 
\[h(t) = d_0 \delta_0(t) + \left[\sum_{i=1}^r \sum_{l=0}^{\mu_i - 1} d_{i,l} e^{\lambda_it} \frac{t^l}{l!}\right]\delta_{-1}(t)\]
Essendo $n \neq m$ il sistema non è proprio perciò $d_0 = 0$.
\begin{align*}
    h(t) &= \left[\sum_{i=1}^r \sum_{l=0}^{\mu_i - 1} d_{i,l} e^{\lambda_it} \frac{t^l}{l!}\right]\delta_{-1}(t)\\
    &= (d_1e^{-t} + d_2e^{6t})\delta_{-1}(t)
\end{align*}
Calcoliamo ora le derivate di $h(t)$ (Questa in basso è un'equazione unica):
\[h'(t) = (-d_1e^{-t} + 6d_2e^{6t})\delta_{-1}(t) + (d_1e^{-t} + d_2e^{6t})\delta_{0}(t)\]
\[h''(t) = (d_1e^{-t} - 36d_2e^{6t})\delta_{-1}(t) + (-d_1e^{-t} + 6d_2e^{6t})\delta_{0}(t) + ...\]
\[... + (-d_1e^{-t} + 6d_2e^{6t})\delta_{0}(t) +  (d_1e^{-t} + d_2e^{6t})\delta'(t)\]
Ora poniamo $v(t) = h(t)$ e $u(t) = \delta(t)$ nell'equazione del sistema iniziale:
\[h''(t) - 5h'(t) - 6h(t) = \delta'(t) + 5\delta(t)\]
Sostituiamo ed elimino i gradini:
\[\overbrace{\cancel{(d_1e^{-t} - 36d_2e^{6t})\delta_{-1}(t)} + 2\delta_0(t)(-d_1e^{-t} + 6d_2e^{6t}) +  (d_1e^{-t} + d_2e^{6t})\delta'(t)}^{h''(t)} - ...\]
\[... - 5\overbrace{\left[\cancel{(-d_1e^{-t} + 6d_2e^{6t})\delta_{-1}(t)} + (d_1e^{-t} + d_2e^{6t})\delta_{0}(t)\right]}^{h'(t)} - 6\overbrace{\cancel{\left[(d_1e^{-t} + d_2e^{6t})\delta_{-1}(t)\right]}}^{h(t)}\]
\[= \delta'(t) + 5\delta(t)\]
Ora raccolgo le funzioni delta e le metto a sistema. Ricordiamo di imporre $t = 0$:
\begin{align*}
&\begin{cases}
    \cancel{\delta'(t)}(d_1e^{-t} + d_2e^{6t}) = \cancel{\delta'(t)}\\
    2\delta_0(t)(-d_1e^{-t} + 6d_2e^{6t}) - 5\delta_0(t) (d_1e^{-t} + d_2e^{6t}) = 5\delta(t)
\end{cases}\\
&\begin{cases}
    d_1 + d_2 = 1\\
    -2d_1\delta_0(t) + 12d_2\delta_0(t) - 5d_1\delta_0(t) - 5d_2\delta_0(t) = 5\delta(t)
\end{cases}\\
&\begin{cases}
    d_1 = 1 - d_2\\
    -7d_1\cancel{\delta_0(t)} + 7d_2\cancel{\delta_0(t)} = 5\cancel{\delta(t)}
\end{cases}\\
&\begin{cases}
    d_1 = \frac{1}{7}\\
    d_2 = \frac{6}{7}
\end{cases}
\end{align*}
Quindi la risposta forzata è:
\begin{equation*}
    \tcbox[nobeforeafter]{\(h(t) = \frac{1}{7}e^{-t}\delta_{-1}(t) + \frac{6}{7}e^{6t}\delta_{-1}(t)\)}
\end{equation*}

\subsection{Esercizio 2}

\begin{examplebox}{Consegna}
    Dato il seguente sistema a tempo continuo (LTI):
    \[2v''(t) - 3v'(t) - 2v(t) = 2u'(t) + u(t)\]
    e le seguenti condizioni iniziali:
    \[\begin{cases}
        v(0) = 4\\
        v'(0) = -2
    \end{cases}\]
    Calcolare la risposta libera (1) e la risposta forzata/impulsiva del sistema (2).
\end{examplebox}
1. Polinomio caratteristico:

    \[2s^2 - 3s - 2 = (2s + 1)(s - 2)\]
    \[\lambda_1 = -\frac{1}{2}, \lambda_2 = 2\]
    \[\mu_1 = 1, \mu_2 = 1, r = 2\]
    \[v_l(t) = c_1e^{-\frac{1}{2}t} + c_2e^{2t}\]
Ora derivo $v(t)$:
\[v'(t) = -\frac{1}{2}c_1e^{-\frac{1}{2}t} + 2c_2e^{2t}\]
Applico le condizioni iniziali:
\[\begin{cases}
    v(0) = 4\\
    v'(0) = -2
\end{cases} \begin{cases}
    c_1e^{-\frac{1}{2}t} + c_2e^{2t} = 4\\
    -\frac{1}{2}c_1e^{-\frac{1}{2}t} + 2c_2e^{2t} = -2 
\end{cases} \Longrightarrow
\begin{cases}
    c_1 + c_2 = 4\\
    -\frac{1}{2}c_1 + 2c_2 = -2
\end{cases}\] \[\begin{cases}
    c_1 = 4 - c_2\\
    -\frac{1}{2}(4 - c_2) + 2c_2 = -2
\end{cases}
\begin{cases}
    c_1 = 4 - c_2\\
    \frac{5}{2}c_2 = 0
\end{cases} \Longrightarrow \begin{cases}
    c_1 = 4\\
    c_2 = 0
\end{cases}\]
Quindi la risposta libera è:
\begin{equation*}
    \tcbox[nobeforeafter]{\(v_l(t) = 4e^{-\frac{1}{2}t}\)}
\end{equation*}
2. Ora calcoliamo la risposta impulsiva. 
\begin{align*}
    h(t) &= \overbrace{d_0}^{0} \delta_0(t) + \left[\sum_{i=1}^r \sum_{l=0}^{\mu_i - 1} d_{i,l} e^{\lambda_it} \frac{t^l}{l!}\right]\delta_{-1}(t)\\
    &= (d_1e^{-\frac{1}{2}t} + d_2e^{2t})\delta_{-1}(t)
\end{align*}
Calcoliamo le deritate bla bla bla mi sono rotto:
\[h'(t) = \left(-\frac{1}{2}d_1e^{-\frac{1}{2}t} + 2d_2e^{2t}\right)\delta_{-1}(t) + (d_1e^{-\frac{1}{2}t} + d_2e^{2t})\delta_{0}(t)\]
\begin{align*}
    h''(t) &= \left(\frac{1}{4}d_1e^{-\frac{1}{2}t} + 4d_2e^{2t}\right)\delta_{-1}(t) + \left(-\frac{1}{2}d_1e^{-\frac{1}{2}t} + 2d_2e^{2t}\right)\delta_{0}(t) + ...\\
    &+ \left(-\frac{1}{2}d_1e^{-\frac{1}{2}t} + 2d_2e^{2t}\right)\delta_{0}(t)+ (d_1e^{-\frac{1}{2}t} + d_2e^{2t})\delta'(t)
\end{align*}
Ora poniamo $v(t) = h(t)$ e $u(t) = \delta(t)$ nell'equazione del sistema iniziale:
 \[2h''(t) - 3h'(t) - 2h(t) = 2\delta'(t) + \delta(t)\]
Ora sostituiamo ed eliminiamo i gradini (Questa è un'equazione unica):
\[2\overbrace{\left[\cancel{\left(\frac{1}{4}d_1e^{-\frac{1}{2}t} + 4d_2e^{2t}\right)\delta_{-1}(t)} + 2\delta_0(t)\left(-\frac{1}{2}d_1e^{-\frac{1}{2}t} + 2d_2e^{2t}\right)+ (d_1e^{-\frac{1}{2}t} + d_2e^{2t})\delta'(t)\right]}^{h''(t)} -\]
\[- 3\overbrace{\left[\cancel{\left(-\frac{1}{2}d_1e^{-\frac{1}{2}t} + 2d_2e^{2t}\right)\delta_{-1}(t)} + (d_1e^{-\frac{1}{2}t} + d_2e^{2t})\delta_{0}(t)\right]}^{h'(t)} -  \cancel{2\overbrace{(d_1e^{-\frac{1}{2}t} + d_2e^{2t})\delta_{-1}(t)}^{h(t)}}\]
\[= 2\delta'(t) + \delta(t)\]
Mettiamo a sistema i corrispettivi delta:
\begin{align*}
&\begin{cases}
    \cancel{\delta'(t)}(d_1e^{-\frac{1}{2}t} + d_2e^{2t}) = \cancel{\delta'(t)}\\
    2\delta_0(t)\left(-\frac{1}{2}d_1e^{-\frac{1}{2}t} + 2d_2e^{2t}\right) + \delta_0(t)(d_1e^{-\frac{1}{2}t} + d_2e^{2t})= \delta(t)
\end{cases}\\
&\begin{cases}
    d_1 + d_2 = 1\\
    \cancel{-d_1\delta_0(t)} + 4d_2\delta_0(t) + \cancel{d_1\delta_0(t)} + d_2\delta_0(t) = \delta_0(t)
\end{cases}\\
&\begin{cases}
    d_1 = 1 - d_2\\
    \cancel{\delta_0(t)}5d_2 = \cancel{\delta_0(t)}
\end{cases}\\
&\begin{cases}
    d_1 = \frac{4}{5}\\
    d_2 = \frac{1}{5}
\end{cases}
\end{align*}
Quindi la risposta forzata è:
\begin{equation*}
    \tcbox[nobeforeafter]{\(h(t) = \frac{4}{5}e^{-\frac{1}{2}t}\delta_{-1}(t) + \frac{1}{5}e^{2t}\delta_{-1}(t)\)}
\end{equation*}  

\subsection{Esercizio 3}

\begin{examplebox}{Consegna}
    Dato il seguente sistema a tempo continuo (LTI):
    \[v''(t) + 2v'(t) + v(t) = u''(t) + u(t)\]
    e le seguenti condizioni iniziali:
    \[\begin{cases}
        v(0) = 4\\
        v'(0) = -2
    \end{cases}\]
    Calcolare la risposta libera (1) e la risposta forzata/impulsiva del sistema (2).
    \end{examplebox}
1. Polinomio caratteristico:
\[s^2 + 2s + 1 = (s+1)^2\]
\[\lambda_1 = -1, \mu_1 = 2\]
\[r = 1\]
\[v(t) = c_{1,0}e^{-t} + c_{1,1}e^{-t}t\]
Per semplicità chiamerò $c_{1,0} = c_1$ e $c_{1,1} = c_2$.
Ora derivo $v(t)$:
\[v'(t) = -c_1e^{-t} - c_2e^{-t}t + c_2e^{-t}\]
Applico le condizioni iniziali:
\[\begin{cases}
    v(0) = 4\\
    v'(0) = -2
\end{cases} \begin{cases}
    c_1\overbrace{e^{-t}}^{1} + \overbrace{c_2e^{-t}t}^{0} = 4\\
    -c_1\overbrace{e^{-t}}^{1} - \overbrace{c_2e^{-t}t}^{0} + c_2\overbrace{e^{-t}}^{1}= -2
\end{cases} \Longrightarrow
\begin{cases}
    c_1 = 4\\
    c_2 = 2
\end{cases}\]
Quindi la risposta libera è:
\begin{equation*}
    \tcbox[nobeforeafter]{\(v_l(t) = 4e^{-t} + 2e^{-t}t\)}
\end{equation*}
2. Ora calcoliamo la risposta impulsiva.
\begin{align*}
    h(t) &= \overbrace{d_0}^{0} \delta_0(t) + \left[\sum_{i=1}^r \sum_{l=0}^{\mu_i - 1} d_{i,l} e^{\lambda_it} \frac{t^l}{l!}\right]\delta_{-1}(t)\\
    &= (d_1e^{-t} + d_2e^{-t}t)\delta_{-1}(t)
\end{align*}
Calcoliamo le derivate di $h(t)$:
\[h'(t) = (-d_1e^{-t} + -d_2e^{-t}t + d_2e^{-t})\delta_{-1}(t) + (d_1e^{-t} + d_2e^{-t}t)\delta_{0}(t)\]
\[h''(t) = (d_1e^{-t} + d_2e^{-t}t - 2(d_2e^{-t}))\delta_{-1}t + 2\delta_0(t)((-d_1e^{-t} + -d_2e^{-t}t + d_2e^{-t}))  + ...\]
\[... + (d_1e^{-t} + d_2e^{-t}t)\delta'(t) \]
Ora poniamo $v(t) = h(t)$ e $u(t) = \delta(t)$ nell'equazione del sistema iniziale:
\[h''(t) + 2h'(t) + h(t) = \delta''(t) + \delta(t)\]
Sostituiamo ed eliminiamo i gradini:
\[\overbrace{\cancel{(d_1e^{-t} + d_2e^{-t}t - 2(d_2e^{-t}))\delta_{-1}t} + 2\delta_0(t)((-d_1e^{-t} + -d_2e^{-t}t + d_2e^{-t})) + (d_1e^{-t} + d_2e^{-t}t)\delta'(t)}^{h''(t)} + ...\]
\[2\overbrace{\left[\cancel{(-d_1e^{-t} + -d_2e^{-t}t + d_2e^{-t})\delta_{-1}(t)} + (d_1e^{-t} + d_2e^{-t}t)\delta_{0}(t) \right]}^{h'(t)} + \cancel{(d_1e^{-t} + d_2e^{-t}t)\delta_{-1}(t)}\]
\[= \delta''(t) + \delta(t)\]
Mettiamo a sistema i corrispettivi delta e poniamo $t = 0$:
\begin{align*}
&\begin{cases}
    0 = \delta''(t)\\
    (d_1e^{-t} + d_2e^{-t}t)\delta'(t) = 0\\
    2\delta_0(t)((-d_1e^{-t} + \cancel{-d_2e^{-t}t} + d_2e^{-t})) + 2\delta_0(t)(d_1e^{-t} + \cancel{d_2e^{-t}t})= \delta_0(t)
\end{cases}\\
&\begin{cases}
    d_1 = 0\\
    2\delta_0(t)(-d_1 + d_2) + 2d_1\delta_0(t) = \delta_0(t) 
\end{cases}\\
&\begin{cases}
    d_1 = 0\\
    -2d_1\cancel{\delta_0(t)} + 2d_2\cancel{\delta_0(t)} + 2d_1\cancel{\delta_0(t)} = \cancel{\delta_0(t)}
\end{cases}\\
&\begin{cases}
    d_1 = 0\\
    2d_2 = 1 \Longrightarrow d_2 = \frac{1}{2}
\end{cases}
\end{align*}
Quindi la risposta forzata è:
\begin{equation*}
    \tcbox[nobeforeafter]{\(h(t) = \frac{1}{2}e^{-t}t\delta_{-1}(t)\)}
\end{equation*}


\section{Esercizi sulla convoluzione e la risposta forzata}


\subsection{Esercizio 1}
calcolare il prodotto di convoluzione tra:
\[h(t) = \delta_0(t) - 2e^{-t}\delta_{-1}(t) \]
\[u(t) = (1+e^{-t})\delta_{-1}(t)\]
Procediamo con il calcolo della convoluzione utilizzando l'integrale:

\begin{equation*}
    \scalebox{0.8}
    {
    $\begin{aligned}
        v_f(t) = (h \ast u)(t) &= \int_{-\infty}^{+\infty}h(\tau)u(t-\tau)d\tau\\
        &= \int_{-\infty}^{+\infty}(\delta_0(\tau) - 2e^{-\tau}\delta_{-1}(\tau))(1+e^{-(t-\tau)})\delta_{-1}(t-\tau)d\tau\\
        &= \int_{\cancel{-\infty}\; 0^-}^{\cancel{+\infty}\; 0^+} \cancel{\delta_0(\tau)\delta_{-1}(t-\tau)}d\tau + \int_{\cancel{-\infty}\; 0^-}^{\cancel{+\infty}\; 0^+} \cancel{\delta_0(\tau)\delta_{-1}(t-\tau)}e^{-(t-\tau)}d\tau\\
        &- 2\int_{\cancel{-\infty}\; 0}^{\cancel{+\infty}\; t} e^{-\tau}\cancel{\delta_{-1}(\tau)\delta_{-1}(t-\tau)}d\tau - 2\int_{\cancel{-\infty}\; 0}^{\cancel{+\infty}\; t} e^{-\tau}e^{-(t-\tau)}\cancel{\delta_{-1}(\tau)\delta_{-1}(t-\tau)}d\tau\\
        &= -2 \int_{0}^{t} e^{-\tau} d\tau - 2e^{-t}\int_{0}^{t}d\tau = -2\left[-e^{-\tau}\bigg|_{0}^t\right] -2e^{-t}\left[\tau\bigg|_{0}^t\right]\\
        &= -2[-e^{-t} + 1] -2e^{-t}t\\
        &= (2e^{-t} - 2 - 2e^{-t}t)\underbrace{\delta_{-1}(t)}_{\text{causale}}
    \end{aligned}$
    }
\end{equation*}

\subsection{Esercizio 2}

Dato il seguente sistema LTI: 
\[v'(t) + 4v(t) = u(t)\]
Calcolare la risposta forzata considerando la seguente funzione in input:
\[u(t) = \delta_0(t) + e^{-t}\delta_{-1}(t)\]
Polinimonio caratteristico: $s + 4 = 0 \Longrightarrow \lambda = -4, \mu = 1, l = 0$\\
Risposta impulsiva: $h(t) = d_1e^{-4t}\delta_{-1}(t)$\\
Riscrivo l'eq sostituendo:
\[h'(t) + 4h(t) = \delta_0(t)\]
\[h'(t) = -4d_1e^{-4t}\delta_{-1}(t) + d_1e^{-4t}\delta_0(t)\]
\[\cancel{-4d_1e^{-4t}\delta_{-1}(t)} + d_1e^{-4t}\delta_0(t) + \cancel{4d_1e^{-4t}\delta_{-1}(t)} = \delta_0(t)\]
\[d_1e^{-4t}\cancel{\delta_0(t)} = \cancel{\delta_0(t)}\]
\[d_1 = 1\]
Quindi \[h(t) = e^{-4t}\delta_{-1}(t)\]
Ora facciamo la convoluzione tra $h(t)$ e $u(t)$:
\begin{equation*}
    \scalebox{0.9}
    {
    $\begin{aligned}
        v_f(t) &= \int_{-\infty}^{+\infty}h(\tau)u(t-\tau)d\tau\\
        &= \int_{-\infty}^{+\infty} (\delta_0(t) + e^{-\tau}\delta_{-1}(\tau))e^{-4(t-\tau)}\delta_{-1}(t-\tau)d\tau\\
        &= \int_{\cancel{-\infty} \; 0^-}^{\cancel{+\infty} \; 0^+} \cancel{\delta_0(t)\delta_{-1}(t-\tau)}e^{-4(t-\tau)}d\tau + \int_{\cancel{-\infty}\; 0}^{\cancel{+\infty} \; t} \cancel{\delta_0(\tau)\delta_{-1}(t-\tau)}e^{-\tau}e^{-4t+4\tau}d\tau \\
        &= \cancel{e^{-4t}\int_{0^-}^{0^+}e^{4\tau}d\tau} + e^{-4t}\int_{0}^{t}e^{3\tau}d\tau\\
        &= e^{-4t}\left[\frac{1}{3}e^{3\tau}\bigg|_{0}^{t}\right] = \frac{1}{3}(e^{-t} - e^{-4t})\delta_{-1}(t)
    \end{aligned}$
    }
\end{equation*}

\subsection{Esercizio 3}

Dato il seguente sistema LTI:
\[v''(t) - v'h(t) + 4v(t) = u''(t) + 3u'(t) + 2u(t)\]
E il seguente input $u(t) = 3\delta_{-1}(t)$. Calcolare la risposta forzata del sistema.\\
Polinomio caratteristico: $s^2 - s + 4 = 0 \Longrightarrow \lambda = (s-2)^2 \Longrightarrow \lambda_1 = 2, \mu_1 = 2$\\
\[h(t) = d_0\delta_0(t) + (d_1e^{2t} + d_2e^{2t}t)\delta_{-1}(t)\]
\begin{align*}
    h'(t) &= d_0\delta'(t) + (2d_1e^{2t} + 2d_2e^{2t}t + d_2e^{2t})\delta_{-1}(t) + (d_1e^{2t} + d_2e^{2t}t)\bigg|_{t=0}\delta_{0}(t)\\
    &= d_0\delta'(t) + (2d_1e^{2t} + 2d_2e^{2t}t + d_2e^{2t})\delta_{-1}(t) + d_1\delta_{0}(t)
\end{align*}
\begin{align*}
    h''(t) &= d_0\delta''(t) + (4d_1e^{2t} + 4d_2e^{2t}t + 2d_2e^{2t} + 2d_2e^{2t})\delta_{-1}(t)\\
    &+ (2d_1e^{2t} + 2d_2e^{2t}t + d_2e^{2t})\bigg|_{t=0}\delta_{0}(t) + d_1\delta'(t)\\
    &= d_0\delta''(t) + (4d_1e^{2t} + 4d_2e^{2t}t + 2d_2e^{2t} + 2d_2e^{2t})\delta_{-1}(t)\\
    &+ (2d_1 + d_2e^{2t})\delta_{0}(t) + d_1\delta'(t)\\
\end{align*}
Ora riscriviamo sostituendo $v(t) = u(t)$ e $u(t) = \delta(t)$ ed eliminando i gradini:
\[d_1\delta''(t) + (2d_1 + d_2)\delta_0(t) + d_1\delta'{t} - 4(d_0\delta'(t) + d_1\delta_0(t)) + d_0\delta_0(t)\]
\[= 3\delta''(t) + 3\delta'(t) + 2\delta(t)\]
Ora mettiamo a sistema i corrispettivi delta:
\begin{align*}
&\begin{cases}
    d_1\delta''(t) = \delta''(t)\\
    d_1\delta'(t) - 4d_0\delta'(t) = 3\delta'(t)\\
    (2d_1 + d_2)\delta_0(t) - 4d_1\delta_0(t) + d_0\delta_0(t) = 2\delta_0(t)
\end{cases}\\
&\begin{cases}
    d_1 = 1\\
    d_0 = \frac{1}{2}\\
    2 + d_2 - 4 + \frac{1}{2} = 2 \Longrightarrow d_2 = \frac{7}{2}
\end{cases} 
\end{align*}
\[h(t) = \frac{1}{2}\delta_0(t) + \left(e^{2t} + \frac{7}{2}e^{2t}t\right)\delta_{-1}(t)\]
Ora facciamo la convoluzione con $u(t)$:
\begin{align*}
    \int_{-\infty}^{+\infty} h(\tau)u(t-\tau) &= \int_{-\infty}^{+\infty} \left(\frac{1}{2}\delta_0(t) + \left(e^{2t} + \frac{7}{2}e^{2t}t\right)\delta_{-1}(t)\right)(3\delta_{-1}(t)) \\
    &= \frac{3}{2} + 3\left[e^{2\tau}\right]_0^t + \frac{21}{2}\left[\frac{\tau e^{2\tau}}{2} - \frac{e^{2\tau}}{4}\right]_0^t\\
    &= 3e^{2t} + \frac{21}{2}te^{2t} - \frac{21}{8}e^{2t} - \frac{3}{2}\\
\end{align*}

\subsection{Esercizio 4}

Dato il seguente sistema LTI:
\[v''(t) + 3v'(t) + 2v(t) = \frac{1}{3}u(t)\]
Calcolare la risposta forzata del sistema tramite questo input:
\[u(t) = e^{-2t}\delta_{-1}(t)\]
\[h(t) = (d_1e^{-2t} + d_2e^{-t})\delta_{-1}(t)\]
\[h'(t) = (-2d_1e^{-2t} - d_2e^{-t})\delta_{-1}(t) +(d_1 + d_2)\delta_0(t)\]
\[h''(t) = (-4d_1e^{-2t} + d_2e^{-t})\delta_{-1}(t) + (-2d_1 - d_2)\delta(t) + (d_1 + d_2)\delta'(t) \]
Ora sostituiamo $v(t) = h(t)$ e $u(t) = \delta(t)$ nell'equazione del sistema:
\[-(2d_1 + d_2)\delta(t) + (d_1 + d_2)\delta'(t) + 3(d_1 + d_2)\delta(t) = \frac{1}{3}\delta(t)\]
\[\begin{cases}
    - 2d_1 - d_2 + 3d_1 + 3d_2 = \frac{1}{3}\\
    (d_1 + d_2)\delta'(t) = 0
\end{cases} \Longrightarrow 
\begin{cases}
    d_1 = \frac{1}{6}\\
    d_2 = -\frac{1}{6}
\end{cases}
\]

\[h(t) = \left(\frac{1}{6}e^{-2t} - \frac{1}{6}e^{-t}\right)\delta_{-1}(t)\]
Ora facciamo la convoluzione con $u(t)$:
\begin{equation*}
    \scalebox{0.8}
    {
    $\begin{aligned}
        (h \ast u)(t) &= \int_{-\infty}^{+\infty} \left(\frac{1}{6}e^{-2t} - \frac{1}{6}e^{-t}\right)\delta_{-1}(t)(e^{-2(t-\tau)}\delta_{-1}(t-\tau))d\tau\\
        &= \frac{1}{6}\int_{\cancel{-\infty}\;0}^{\cancel{+\infty}\;t} \cancel{e^{-2\tau}}e^{-2t+\cancel{2\tau}}\cancel{\delta_{-1}(\tau)\delta_{-1}(t-\tau)}d\tau + \frac{1}{6}\int_{\cancel{-\infty}\;0}^{\cancel{+\infty}\;t} \cancel{e^{-\tau}}e^{-2t+\cancel{2\tau}}\cancel{\delta_{-1}(\tau)\delta_{-1}(t-\tau)}d\tau\\
        &= \frac{1}{6}e^{-2t}t + \frac{1}{6}e^{-2t}\int_{0}^{t} e^{\tau}d\tau\\
        &= \frac{1}{6}e^{-2t}t + \frac{1}{6}e^{-2t}(e^t-1)\\
        &= \frac{1}{6}e^{-2t}t + \frac{1}{6}e^{-t} - \frac{1}{6}e^{-2t}\\
        &= \frac{1}{6}\left(e^{-2t}t + e^{-t} - e^{-2t}\right)
    \end{aligned}$
    }
\end{equation*}

\pagebreak
\section{Esercizi fatti in classe}
\subsection{Esercizio 1}
\begin{examplebox}{Consegna}
\[v''(t) - 5v'(t) + 4v(t) = u'(t) - 3u(t)\]
\[C.I = \begin{cases}
    v(0) = 9\\
    v'(0) = 1
\end{cases}\]
\[u(t)\ = e^t\delta_{-1}(t)\]
\begin{enumerate}
    \item  Discutere la stabilità del sistema.
    \item Determinare la FdT (H(s)) (Solo in Laplace quindi non serve in t)
    \item Calcolare la risposta impulsiva h(t) (quindi $\mathcal{L}^{-1}[H(s)](t)$)
    \item Calcolare la risposta totale $v_t(t)$
\end{enumerate}
\end{examplebox}
\noindent
\[s^2 -5s + 4 = 0\]
\[\lambda_1 = +1, \lambda_2 = +4, \mu_i = 1\]
\textbf{Sistema instabile} poiché $Re(\lambda_i) > 0$.
\[\mathcal{L}[v''(t) - 5v'(t) + 4v(t)](s) = \mathcal{L}[u'(t) - 3u(t)](s)\]
\[\mathcal{L}[v''(t)] = s^2V(s) - \cancel{sv(0)} - \overbrace{{v'(0)}}^{1} = s^2V(s) - 1\]
\[-5\mathcal{L}[v'(t)](s) = -5[SV(s) - sv(0)] = -5SV(s)\]
\[+4\mathcal{L}[v(t)](s) = +4V(s)\]
È sempre sottinteso che $u^i(0) = 0$.
\[\mathcal{L}[u'(t)] = sU(s) + su(0) = sU(s)\]
\[\mathcal{L}[u(t)](s) = -3U(s)\]
Ora che abbiamo i diversi pezzetini possiamo ricostruire l'equazione iniziale:
\[S^2V(s) - 1 - 5V(s) + 4V(s) = sU(s) - 3U(s)\]
\[V(s)(S^2 - 5 + 4) - 1 = sU(s) - 3U(s)\]
\[V(s) = \frac{\overbrace{1}^{p(s)}}{\underbrace{(s-1)(s-4)}_{d(s)}} + \frac{\overbrace{s-3}^{n(s)}}{\underbrace{(s-1)(s-4)}_{d(s)}}U(s)\]
Parliamo della BIBO stabilità. Sia $\lambda_i$ polo di H(s) e $Re(\lambda_i) < 0$ allora il sistema è BIBO stabile. In questo caso abbiamo due poli $\lambda_1 = 1$ e $\lambda_2 = 4$ che sono 
entrambi positivi quindi il sistema non è né stabile né BIBO stabile.\\
2. Calcoliamo la FdT che abbiamo già trovato precedentemente:
\begin{equation*}
    \tcbox[nobeforeafter]{\(H(s) = \frac{s-3}{(s-1)(s-4)}\)}
\end{equation*}
3. 
\[h(t) = \mathcal{L}^{-1}[H(s)](t)\]
Controlliamo i gradi di $n(s)$ e $d(s)$. 
\[V(s) = \frac{n(s)}{d(s)} \Longrightarrow \begin{cases}
    \underbrace{deg[n(s)] \ge deg[d(s)]}_{\text{Sistema proprio}}\\
    \underbrace{deg[n(s)] < deg[d(s)]}_{\text{Sistema strett. proprio}} 
\end{cases}\]
Se il sistema è proprio allora $\Longrightarrow$ Divisione fra polinomi poi Fratti semplici e poi antitrasformata. Altrimenti
se è strettamente proprio allora $\Longrightarrow$ Fratti semplici e poi antitrasformata.\\
In questo caso il sistema è strettamente proprio quindi dobbiamo fare i fratti semplici:
\[H(s) = \frac{s-3}{(s-1)(s-4)} = \frac{A}{s-1} + \frac{B}{s-4}\]
Utilizziamo il metodo dei limiti per trovare A e B: 
\[c_{i} = \lim_{s \rightarrow \lambda_i}\frac{d^{\mu - l - 1}n(s)}{ds^{s-l-1}d(s)}(s-\lambda)^\mu\]
\[A = \lim_{s \rightarrow +1}\frac{d^{1 - 0 - 1}(s-3)}{ds^{1-0-1}\cancel{(s-1)}(s-4)}\cancel{(s-1)} = \frac{2}{3}\]
\[B = \lim_{s \rightarrow +4}\frac{d^{1 - 0 - 1}(s-3)}{ds^{1-0-1}\cancel{(s-4)}(s-1)}\cancel{(s-4)} = \frac{1}{3}\]
\[h(t) = \frac{2}{3}\frac{1}{(s-1)} + \frac{1}{3}\frac{1}{(s-4)} \stackrel{\mathcal{L}^{-1}}{=} \left(\frac{2}{3}e^t + \frac{1}{3}e^{4t}\right)\delta_{-1}(t)\]
4. Risposta totalen $v_t(t)$:
\[v_t(t) = v_l(t) + v_f(t)\]
\[V(s) = \underbrace{\frac{1}{(s-1)(s-4)}}_{V_l(s)} + \underbrace{\frac{s-3}{(s-1)(s-4)}U(s)}_{V_f(s)}\]
Ora dobbiamo trovare $U(s)$:
\[U(s) = \mathcal{L}[u(t)](s) = \mathcal{L}[e^t\delta_{-1}(t)](s) = \frac{1}{s-1}\]
Quindi: 
\begin{align*}
V(s) &= \underbrace{\frac{1}{(s-1)(s-4)}}_{V_l(s)} + \underbrace{\frac{s-3}{(s-1)^2(s-4)}U(s)}_{V_f(s)}\\
&= \frac{s-1 + s-3}{(s-1)^2(s-4)}\\
& = \frac{2s - 4}{(s-1)^2(s-4)} = v_t(s)
\end{align*}
Ora dobbiamo trovare $V_f(s)$:
\[V_f(s) = \frac{A}{(s-1)} + \frac{B}{(s-1)^2} + \frac{C}{(s-4)}\]
Qua ci torna utile il metodo dei limiti:
\begin{align*}
A &= \lim_{s \rightarrow 1} \frac{d^{2-0-1}}{ds^{2-0-1}} \cancel{(s-1)^2}\frac{2s-4}{\cancel{(s-1)^2}(s-4)}\\
&= \frac{d}{ds} \frac{2s - 4}{s-4}\bigg|_{s=1} \\
&= \frac{2(s-4) - (2s-4)(1)}{(s-4)^2}\bigg|_{s=1}\\
&= \frac{-4}{(1-4)^2} = -\frac{4}{9}
\end{align*}
\begin{align*}
B &= \lim_{s \rightarrow 1} \frac{d^{2-1-1}}{ds^{2-1-1}} \cancel{(s-1)^2}\frac{2s-4}{\cancel{(s-1)^2}(s-4)}\\
&= \lim_{s \rightarrow 1} \frac{2s - 4}{s-4} = \frac{2}{3}\\
\end{align*}
\begin{align*}
C &= \lim_{s \rightarrow 4} \frac{d^{1-0-1}}{ds^{1-0-1}} \cancel{(s-4)}\frac{2s-4}{(s-1)^2\cancel{(s-4)}}\\
&= \lim_{s \rightarrow 4} \frac{2s-4}{(s-1)^2} = \frac{4}{9}
\end{align*}
Quindi:
\begin{equation*}
    \tcbox[nobeforeafter]{\(V_t(s) = -\frac{4}{9}\frac{1}{(s-1)} + \frac{2}{3}\frac{1}{(s-1)^2} + \frac{4}{9}\frac{1}{(s-4)}\)}
\end{equation*}
Quindi $v_f(t)$, applichiamo l'antitrasformata e otteniamo:
\begin{equation*}
    \tcbox[nobeforeafter]{\(v_t(t) = \left(-\frac{4}{9}e^t + \frac{2}{3}te^t + \frac{4}{9}e^{4t}\right)\delta_{-1}(t)\)}
\end{equation*}
\subsection{Esercizio 2}
\begin{examplebox}{Consegna}
    \[v''(t) + 4v'(t) + 4v(t) = u'(t)\]
    \[C.I = \begin{cases}
        v(0) = 1\\
        v'(0) = 0
    \end{cases}\]
    \[u(t) = sin(t)cos(t)\delta_{-1}(t)\]
    \begin{enumerate}
        \item Risposta libera
        \item Risposta forzata
    \end{enumerate}
\end{examplebox}
\[S^2V(s) - sv(0) - \cancel{v'(0)} + 4(SV(s) - v(0)) + 4V(s) = sU(s)\]
\[V(s)(s^2 - 4s + 4) - s - 4 = sU(s)\]
\begin{align*}
    V(s) &= \frac{s+4}{(s^2+4s+4)} + \frac{s}{(s^2+4s+4)}U(s)\\
    &= \frac{s+4}{(s+2)^2} + \frac{s}{(s+2)^2}U(s)
\end{align*}
Questo sistema è stabile e quindi anche BIBO stabile.\\
1. 
\[v_l(s) = \frac{s+4}{(s+4)^2} = \frac{A}{s+2} + \frac{B}{(s+2)^2}\]
Troviamo $A$ e $B$:
\begin{align*}
   A &= \lim_{s \rightarrow -2} \frac{d}{ds} \cancel{(s+2)^2}\frac{s+4}{\cancel{(s+2)^2}}\\ 
   &= \lim_{s \rightarrow -2} \frac{d(s+4)}{ds} = 1
\end{align*}
\begin{align*}
    B &= \lim_{s \rightarrow -2} \cancel{(s+2)}\frac{s+4}{\cancel{(s+2)^2}} = 2
\end{align*}
\begin{align*}
    V_l(s) &= \frac{1}{s+2} + \frac{2}{(s+2)^2}\\
    &= \mathcal{L}^{-1}\left[\frac{1}{s+2} + \frac{2}{(s+2)^2}\right]\\
    &\stackrel{\mathcal{L}^{-1}}{=} (e^{-2t} + 2te^{-2t})\delta_{-1}(t)
\end{align*}
2. 
\[v_f(s) = \frac{s}{(s+2)^2}U(s)\]
Troviamo $U(s)$: 
\[U(s) = \mathcal{L}^{-1}[u(t)](s)\]
Utilizziamo Eulero per trasformare l'antitrasformata di $u(t) = \sin(t)\cos(t)\delta_{-1}(t)$:
\[\cos(t) = \frac{e^{jt}+e^{-jt}}{2}\]
\[\sin(t) = \frac{e^{jt}-e^{-jt}}{2j}\]
\begin{align*}
    &= \mathcal{L}\left[\frac{e^{jt}-e^[jt]}{2}\frac{e^{jt}+e^{-jt}}{2j}\delta_{-1}(t)\right](s)\\
    &= \frac{1}{4j}\mathcal{L}[(e^{2jt} - e^{-2jt})\delta_{-1}(t)](s)\\
    &= \frac{1}{4j} \left(\frac{1}{s-2j} - \frac{1}{s+2j}\right) = \frac{1}{s^2 + 4}
\end{align*} 
Quindi $V_f(s)$:
\begin{align*}
    V_f(s) &= H(s)U(s)\\
    &= \frac{s}{(s+2)^2}\frac{1}{s^2 + 4}\\
    &= \frac{s}{(s+2)^2(s-2j)(s+2j)}\\
    &= \frac{A}{s+2} + \frac{B}{(s+2)^2} + \frac{C}{s-2j} + \frac{D}{s+2j}
\end{align*}
Troviamo $A, B, C, D$:
\begin{align*}
    A &= \lim_{s \rightarrow -2}\frac{d}{ds} \cancel{(s+2)^2}\frac{s}{\cancel{(s+2)^2}(s^2-4)} = \frac{1}{16}\\
    B &= \lim_{s \rightarrow -2}\cancel{(s+2)^2}\frac{s}{\cancel{(s+2)^2}(s^2+4)} = -\frac{1}{4}\\
    C &= \lim_{s \rightarrow 2j}\cancel{(s-2j)}\frac{s}{(s+2)^2\cancel{(s-2j)}(s+2j)} = \frac{1}{16j}\\
    D &= \lim_{s \rightarrow -2j}\cancel{(s+2j)}\frac{s}{(s+2)^2\cancel{(s+2j)}(s-2j)} = -\frac{1}{16j}
\end{align*}
Andiamo a sostituire e otteniamo:
\[V_f(s) = \frac{1}{16} \frac{1}{s+2} - \frac{1}{4}\frac{1}{(s+2)^2} + \frac{1}{16j}\frac{1}{(s-2j)} - \frac{1}{16j}\frac{1}{(s+2j)}\]
Applichiamo Laplace e otteniamo $v_f(t)$:
\begin{equation*}
    \tcbox[nobeforeafter]{\(v_f(t) = \left(\frac{1}{16}e^{-2t} - \frac{1}{4}te^{-2t} + \underbrace{\frac{1}{16j}e^{2jt} - \frac{1}{16j}e^{-2jt}}_{\left(\frac{e^{2jt} - e^{-2jt}}{2j}\right) = sin(2t)}\right)\delta_{-1}(t)\)}
\end{equation*}
Possiamo semplificare e quindi:
\begin{equation*}
    \tcbox[nobeforeafter]{\(v_f(t) = \left(\frac{1}{16}e^{-2t} - \frac{1}{4}te^{-2t} + \frac{1}{8}sin(2t)\right)\delta_{-1}(t)\)}
\end{equation*}





\end{document}


